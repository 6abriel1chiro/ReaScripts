item = reaper.GetSelectedMediaItem(0, 0)
take = reaper.GetActiveTake(item)
retval, notecntOut, ccevtcntOut, textsyxevtcntOut = reaper.MIDI_CountEvts(take)
if retval ~= nil then
  local pitchOutmax = 0
  for i = 1, notecntOut, 1 do
   retval, selectedOut, mutedOut, startppqposOut, endppqposOut, chanOut, pitchOut, velOut = reaper.MIDI_GetNote(take, i-1)
   pitchOutmax = math.max(pitchOut, pitchOutmax)
  end
  for i = 1, notecntOut, 1 do
   retval, selectedOut, mutedOut, startppqposOut, endppqposOut, chanOut, pitchOut, velOut = reaper.MIDI_GetNote(take, i-1)
   if pitchOut == pitchOutmax then 
     reaper.MIDI_SetNote(take, i-1, false)
     else
     reaper.MIDI_SetNote(take, i-1, true)
   end
  end
end
